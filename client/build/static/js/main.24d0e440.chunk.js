(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(e,t,n){},103:function(e,t,n){},130:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(8),c=n.n(r),i=(n(102),n(21)),l=n(34),s=(n(103),n(19)),u=n.n(s),m=n(74),p=n.n(m),d=n(179),h=n(177),f=n(9),b=n(10),g=n(13),E=n(11),O=n(14),v=n(12),y=n(4),j=n(162),D=function(e,t){return function(n){n({type:"LOADING_UI"}),u.a.post("/user/login",e).then(function(e){S(e.data.token),n(C()),n({type:"CLEAR_ERRORS"}),t.push("/dashboard")}).catch(function(e){n({type:"SET_ERRORS",payload:e.response.data})})}},C=function(){return function(e){e({type:"LOADING_USER"}),u.a.get("/user").then(function(t){e({type:"SET_USER",payload:t.data})}).catch(function(e){console.log("Error setting user."),console.log(e)})}},w=function(){return function(e){T(),e({type:"SET_UNAUTHENTICATED"})}},S=function(e){var t="Bearer ".concat(e);localStorage.setItem("FBIdToken",t),u.a.defaults.headers.common.Authorization=t},T=function(){localStorage.removeItem("FBIdToken"),delete u.a.defaults.headers.common.Authorization},N=function(){return function(e){e({type:"LOADING_DOCUMENT"}),u.a.get("/documents").then(function(t){console.log(t.data),e({type:"SET_DOCUMENTS",payload:t.data})}).catch(function(e){console.log("Error retrieving documents."),console.log(e)})}},I=function(e,t){var n={handle:e,docID:t};u.a.post("/document/addCollaborator",n).then(function(e){console.log(e.data)}).catch(function(e){console.log(e.response.data)})},P=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(g.a)(this,Object(E.a)(t).call(this,e))).state={},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){var e=this.getTextDocumentRef();setTimeout(function(){},1e4);var t=window.CodeMirror(document.getElementById("firepad-container"),{lineWrapping:!0,lineNumbers:!0});console.log(t);var n=window.Firepad.fromCodeMirror(e,t,{richTextToolbar:!1,richTextShortcuts:!0});console.log(n),n.on("ready",function(){console.log("firepad ready"),n.isHistoryEmpty()&&(console.log("History empty()"),n.setHtml("Collaborative-editing made easy.\n"))})}},{key:"getTextDocumentRef",value:function(){var e=window.firebase.database().ref(),t=this.props.document.activeDocument.docID;return console.log("HASH: "+t),console.log(e),t?e=e.child(t):(e=e.push(),window.location=window.location+"#"+e.key),"undefined"!==typeof console&&console.log("Firebase data: ",e.toString()),e}},{key:"render",value:function(){var e=this.props.classes;return console.log(document.loading),o.a.createElement("div",{className:e.textEditor},o.a.createElement("div",{id:"firepad-container",className:e.firepadContainer}))}}]),t}(a.Component),x={loginUser:D,getDocuments:N},U=Object(v.b)(function(e){return{document:e.document}},x)(Object(y.a)(function(e){return{firepadContainer:{backgroundColor:"#282c34",color:"white",height:"1000px"},textEditor:{}}})(P)),k=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(g.a)(this,Object(E.a)(t).call(this,e))).state={},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return o.a.createElement(j.a,{container:!0},o.a.createElement(j.a,{item:!0,xs:2,sm:2,md:2}),o.a.createElement(j.a,{item:!0,xs:8,sm:8,md:8},o.a.createElement(U,null)),o.a.createElement(j.a,{item:!0,xs:2,sm:2,md:2}))}}]),t}(a.Component),_=Object(v.b)(function(e){return{document:e.document}},{})(Object(y.a)(function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"right",color:e.palette.text.secondary,height:"80vh"}}})(k)),A=n(20),R=n(166),H=n(176),L=n(163),M=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(g.a)(this,Object(E.a)(t).call(this,e))).handleChange=function(e){n.setState(Object(A.a)({},e.target.name,e.target.value))},n.handleSubmit=function(e){e.preventDefault();var t={email:n.state.email,password:n.state.password};n.props.loginUser(t,n.props.history)},n.state={email:"",password:"",errors:{}},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement(j.a,{container:!0,className:e.form},o.a.createElement(j.a,{item:!0,sm:!0}),o.a.createElement(j.a,{item:!0,sm:!0},o.a.createElement(L.a,{variant:"h1",className:e.pageTitle},"Login"),o.a.createElement("form",{noValidate:!0,onSubmit:this.handleSubmit},o.a.createElement(H.a,{id:"email",name:"email",type:"email",label:"Email",InputProps:{className:e.input},value:this.state.email,onChange:this.handleChange,fullWidth:!0}),o.a.createElement(H.a,{id:"password",name:"password",type:"password",label:"Password",InputProps:{className:e.input},value:this.state.password,onChange:this.handleChange,fullWidth:!0}),o.a.createElement(R.a,{type:"submit",variant:"contained",color:"primary",className:e.button},"Login"),o.a.createElement(R.a,{color:"primary",component:i.b,to:"/signup"},"Signup"),o.a.createElement("br",null),o.a.createElement("small",null,"Don't have an account? Sign up ",o.a.createElement(i.b,{to:"/signup"},"here.")))),o.a.createElement(j.a,{item:!0,sm:!0}))}}]),t}(a.Component),W={loginUser:D},F=Object(v.b)(function(e){return{user:e.user,UI:e.UI}},W)(Object(y.a)({form:{textAlign:"center",paddingTop:"50px"},input:{color:"white"},image:{margin:"20px auto 20px auto",maxWidth:100},pageTitle:{margin:"10px auto 10px auto",fontSize:50},textField:{margin:"10px auto 10px auto",color:"#fff"},button:{margin:"20px",position:"relative"},customError:{color:"red",fontSize:"0.8rem",marginTop:"10px"},progress:{position:"absolute"}})(M)),z=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(g.a)(this,Object(E.a)(t).call(this,e))).handleChange=function(e){n.setState(Object(A.a)({},e.target.name,e.target.value))},n.handleSubmit=function(e){e.preventDefault(),console.log("Signup.js"),console.log(n.state),n.props.signup(n.state)},n.state={handle:"",email:"",confirmEmail:"",password:"",confirmPassword:""},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement(j.a,{container:!0,className:e.form},o.a.createElement(j.a,{item:!0,sm:!0}),o.a.createElement(j.a,{item:!0,sm:!0},o.a.createElement(L.a,{variant:"h3",className:e.pageTitle},"Signup"),o.a.createElement("form",{noValidate:!0,onSubmit:this.handleSubmit},o.a.createElement(H.a,{id:"handle",name:"handle",type:"text",label:"User Handle",InputProps:{className:e.input},value:this.state.handle,onChange:this.handleChange,fullWidth:!0}),o.a.createElement(H.a,{id:"email",name:"email",type:"email",label:"Email",InputProps:{className:e.input},value:this.state.email,onChange:this.handleChange,fullWidth:!0}),o.a.createElement(H.a,{id:"confirmEmail",name:"confirmEmail",type:"email",label:"Confirm Email",InputProps:{className:e.input},value:this.state.confirmEmail,onChange:this.handleChange,fullWidth:!0}),o.a.createElement(H.a,{id:"password",name:"password",type:"password",label:"Password",InputProps:{className:e.input},value:this.state.password,onChange:this.handleChange,fullWidth:!0}),o.a.createElement(H.a,{id:"confirmPassword",name:"confirmPassword",type:"password",label:"Confirm Password",InputProps:{className:e.input},value:this.state.confirmPassword,onChange:this.handleChange,fullWidth:!0}),o.a.createElement(R.a,{type:"submit",color:"primary"},"Submit"))),o.a.createElement(j.a,{item:!0,sm:!0}))}}]),t}(a.Component),G={signup:function(e){return function(t){console.log("Signing in"),console.log(e),u.a.post("/user/signup",e).then(function(e){console.log(e),S(e.data.token),t(C())}).catch(function(e){console.log(e),t({type:"SET_ERRORS",payload:e.response.data})})}}},B=Object(v.b)(function(e){return{}},G)(Object(y.a)({form:{},pageTitle:{},input:{}})(z)),J=n(78),V=n(3),q=n(79),Y=n.n(q),$=n(165),K=n(168),Q=n(169),X=n(170),Z=n(167),ee=n(180),te={horizontal:{display:"flex",flexDirection:"row",overflow:"auto",whiteSpace:"nowrap"},avatar:{width:80,height:80,"&:hover":{color:Z.a[800],cursor:"pointer"}}},ne=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(g.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(o)))).inviteFriend=function(){n.props.addCollaborator(n.props.handle,n.props.docID)},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.classes;Object(J.loadCSS)("https://use.fontawesome.com/releases/v5.1.0/css/all.css",document.querySelector("#font-awesome-css"));var t=this.props.users.map(function(t){return o.a.createElement(K.a,{key:t},o.a.createElement(ee.a,{title:t,"aria-label":t},o.a.createElement(Q.a,{className:e.avatar},o.a.createElement(Y.a,{size:50,string:t}))))});return o.a.createElement($.a,{className:e.horizontal},o.a.createElement(K.a,null,o.a.createElement(ee.a,{title:"Add","aria-label":"add"},o.a.createElement(Q.a,{className:e.avatar},o.a.createElement(X.a,{className:Object(V.a)("fa fa-plus-circle",e.avatar),color:"action",style:{fontSize:80},onClick:this.inviteFriend})))),t)}}]),t}(a.Component),ae={addCollaborator:I},oe=Object(v.b)(function(e){return{document:e.document}},ae)(Object(y.a)(te)(Object(l.f)(ne))),re=n(171),ce=n(173),ie=n(172),le=n(81),se=n.n(le),ue=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(g.a)(this,Object(E.a)(t).call(this,e))).openDocument=function(e){e.preventDefault(),console.log("Opening document: "+n.props.document.docID),n.props.getDocument(n.props.document.docID),setTimeout(function(){n.props.history.push("/editor")},750)},n.deleteDocument=function(e){e.preventDefault(),n.props.deleteDocument(n.props.docID)},n.handleChange=function(e){n.setState(Object(A.a)({},e.target.name,e.target.value))},n.state={handle:""},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement(o.a.Fragment,null,o.a.createElement(re.a,{className:e.card},o.a.createElement(ie.a,null,o.a.createElement(se.a,{className:e.deleteForever,color:"secondary",onClick:this.deleteDocument}),o.a.createElement(L.a,{className:e.title,color:"textSecondary",onClick:this.openDocument},this.props.document.docID),o.a.createElement(L.a,{variant:"h5",component:"h2"},this.props.document.title),o.a.createElement(L.a,{variant:"body2",component:"p"},this.props.content),o.a.createElement(H.a,{id:"handle",name:"handle",type:"text",label:"User Handle",InputProps:{className:e.input},value:this.state.handle,onChange:this.handleChange,fullWidth:!0})),o.a.createElement(ce.a,null,o.a.createElement(oe,{handle:this.state.handle,docID:this.props.document.docID,users:this.props.document.collaborators}))))}}]),t}(o.a.Component),me={getDocument:function(e){return function(t){t({type:"LOADING_DOCUMENT"}),u.a.get("/document/".concat(e)).then(function(e){t({type:"SET_DOCUMENT",payload:e.data})}).catch(function(e){console.log("Client Error retrieving document."),console.log(e)})}},addCollaborator:I,deleteDocument:function(e){return function(t){console.log("DELETING: "+e),t({type:"LOADING_DOCUMENT"}),u.a.delete("/document",{data:{docID:e}}).then(function(n){t({type:"DELETE_DOCUMENT",payload:e})}).catch(function(e){console.log("Error deleting document"),console.log(e)})}}},pe=Object(v.b)(function(e){return{documents:e.documents}},me)(Object(y.a)({card:{minWidth:275,minHeight:275},deleteForever:{float:"right",cursor:"pointer"},title:{fontSize:14,cursor:"pointer"}})(Object(l.f)(ue))),de=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(g.a)(this,Object(E.a)(t).call(this,e))).handleChange=function(e){n.setState(Object(A.a)({},e.target.name,e.target.value))},n.createNewDocument=function(){console.log(n.props.user.credentials.handle),n.props.createDocument(n.state.title,n.state.content,n.props.user.credentials.handle)},n.state={title:"",content:""},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement(re.a,{className:e.card},o.a.createElement(ie.a,null,o.a.createElement(L.a,{variant:"h5",component:"h2"},"Create New Document"),o.a.createElement(H.a,{id:"title",name:"title",type:"text",label:"Title",InputProps:{className:e.input},value:this.state.title,onChange:this.handleChange,fullWidth:!0}),o.a.createElement(H.a,{id:"content",name:"content",type:"text",label:"Content",InputProps:{className:e.input},value:this.state.content,onChange:this.handleChange,fullWidth:!0}),o.a.createElement(R.a,{variant:"outlined",className:e.add,onClick:this.createNewDocument},"Submit")))}}]),t}(o.a.Component),he={createDocument:function(e,t,n){return function(a){u.a.post("/document",{title:e,content:t,handle:n}).then(function(e){a({type:"CREATE_DOCUMENT",payload:e.data})}).catch(function(e){console.log("Error creating document."),console.log(e)})}}},fe=Object(v.b)(function(e){return{user:e.user}},he)(Object(y.a)({card:{minWidth:275,minHeight:275,position:"relative"},title:{fontSize:14},add:{margin:"20px",right:0,bottom:0,position:"absolute"}})(Object(l.f)(de))),be=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(g.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(o)))).state={documents:null},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.props.getDocuments()}},{key:"render",value:function(){var e=this.props.document,t=e.documents,n=e.loading?o.a.createElement("p",null,"Loading..."):t.map(function(e){return o.a.createElement(j.a,{key:e.docID,item:!0,xs:12,sm:6,md:4,lg:3},o.a.createElement(pe,{document:e}))});return o.a.createElement(j.a,{container:!0,spacing:10},o.a.createElement(j.a,{item:!0,xs:12,sm:6,md:4,lg:3},o.a.createElement(fe,null)),n)}}]),t}(a.Component),ge={loginUser:D,getDocuments:N},Ee=Object(v.b)(function(e){return{document:e.document,UI:e.UI}},ge)(Object(y.a)({})(be)),Oe=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("h1",null,"404: page not found"))}}]),t}(a.Component),ve=n(174),ye=n(175),je=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement(ve.a,{position:"absolute"},o.a.createElement(ye.a,{className:e.navContainer},o.a.createElement(R.a,{color:"inherit",component:i.b,to:"/"},"Home"),o.a.createElement(R.a,{color:"inherit",component:i.b,to:"/dashboard"},"Dashboard"),o.a.createElement(R.a,{color:"inherit",component:i.b,to:"/",onClick:this.props.logoutUser},"Logout"),o.a.createElement(R.a,{color:"inherit",component:i.b,to:"/login"},"Login")))}}]),t}(a.Component),De={logoutUser:w},Ce=Object(v.b)(function(e){return{}},De)(Object(y.a)(function(e){return{navContainer:{backgroundColor:"#282c34"}}})(je)),we=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(g.a)(this,Object(E.a)(t).call(this,e))).state={user:null,noUserFound:!1},n}return Object(O.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,"Hello from home")}}]),t}(a.Component),Se=Object(y.a)({})(we),Te=n(84),Ne=n(5),Ie=function(e){var t=e.component,n=e.authenticated,a=Object(Te.a)(e,["component","authenticated"]);return o.a.createElement(l.b,Object.assign({},a,{render:function(e){return!0===n?o.a.createElement(t,e):o.a.createElement(l.a,{to:"/login"})}}))};Ie.prototype={user:n.n(Ne).a.object};var Pe=Object(v.b)(function(e){return{authenticated:e.user.authenticated}})(Ie),xe=n(36),Ue=n(82);function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(n,!0).forEach(function(t){Object(A.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ae={authenticated:!1,loading:!1,credentials:{}};function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(n,!0).forEach(function(t){Object(A.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Le={content:localStorage.getItem("content"),documentHistory:[],currentUsers:[],client:{}},Me=n(83);function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?We(n,!0).forEach(function(t){Object(A.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ze={activeDocument:null,documents:[],loading:!0},Ge=[Ue.a],Be=Object(xe.c)({data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CLIENT":return He({},e,{client:t.payload});case"ON_MESSAGE":return He({},e,{},t.payload);case"SET_CONTENT":return He({},e,{content:t.payload});case"SET_HISTORY":return He({},e,{documentHistory:t.payload});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_AUTHENTICATED":return _e({},e,{authenticated:!0});case"SET_UNAUTHENTICATED":return Ae;case"SET_USER":return _e({loading:!1,authenticated:!0},t.payload);case"LOADING_USER":return _e({},e,{loading:!0});default:return e}},document:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ze,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DOCUMENT":return Fe({},e,{loading:!0,activeDocument:t.payload});case"SAVE_DOCUMENT":return Fe({},e);case"SET_CONTENT":return Fe({},e,{activeDocument:Fe({},e.activeDocument,{content:t.payload})});case"SET_DOCUMENTS":return Fe({},e,{loading:!1,documents:t.payload});case"LOADING_DOCUMENT":return Fe({},e,{loading:!0});case"CREATE_DOCUMENT":return Fe({},e,{documents:[].concat(Object(Me.a)(e.documents),[t.payload])});case"DELETE_DOCUMENT":return Fe({},e,{loading:!1,documents:e.documents.filter(function(e){return e.docID!==t.payload})});default:return e}}}),Je=function(){try{var e=localStorage.getItem("state");if(null===e)return;return JSON.parse(e)}catch(t){console.log("Error loading state.")}}(),Ve=Object(xe.e)(Be,Je,Object(xe.d)(xe.a.apply(void 0,Ge)));Ve.subscribe(function(){!function(e){try{var t=JSON.stringify(e);localStorage.setItem("state",t)}catch(n){console.log("Error saving state.")}}(Ve.getState())});var qe=Ve;u.a.defaults.baseURL="https://us-central1-novafire-c701c.cloudfunctions.net/api";var Ye=localStorage.FBIdToken;if(Ye){var $e=p()(Ye);console.log($e),1e3*$e.exp<Date.now()?(qe.dispatch(w()),window.location.href="/login"):(qe.dispatch({type:"SET_AUTHENTICATED"}),u.a.defaults.headers.common.Authorization=Ye,qe.dispatch(C()))}var Ke=Object(d.a)({productionPrefix:"c"});var Qe=function(){return o.a.createElement(h.b,{generateClassName:Ke},o.a.createElement(v.a,{store:qe},o.a.createElement(i.a,null,o.a.createElement(Ce,null),o.a.createElement("div",{className:"container"},o.a.createElement(l.b,{exact:!0,path:"/",component:Se}),o.a.createElement(l.b,{exact:!0,path:"/login",component:F}),o.a.createElement(l.b,{path:"/signup",component:B}),o.a.createElement(Pe,{exact:!0,path:"/dashboard",component:Ee}),o.a.createElement(Pe,{path:"/editor",component:_}),o.a.createElement(l.b,{path:["","/error"],component:Oe})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(Qe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},97:function(e,t,n){e.exports=n(130)}},[[97,1,2]]]);
//# sourceMappingURL=main.24d0e440.chunk.js.map