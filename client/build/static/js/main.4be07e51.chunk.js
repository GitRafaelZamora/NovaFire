(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{114:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(8),c=n.n(r),i=(n(88),n(27)),l=n(33),s=(n(89),n(21)),u=n.n(s),m=n(67),p=n.n(m),d=n(159),h=n(156),f=n(11),b=n(12),g=n(14),O=n(13),E=n(15),v=n(16),y=n(5),j=n(148),D=n(115),T=n(145),w=n(74);Object(T.a)(function(e){return{root:{minHeight:"40vh",marginTop:"10px"}}});var C=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return o.a.createElement(j.a,{container:!0,spacing:1,direction:"column"},o.a.createElement(j.a,{item:!0,md:12}),o.a.createElement(j.a,{item:!0,md:12}))}}]),t}(a.Component),S=function(e,t){return function(n){n({type:"LOADING_UI"}),u.a.post("/user/login",e).then(function(e){x(e.data.token),n(N()),n({type:"CLEAR_ERRORS"}),t.push("/")}).catch(function(e){n({type:"SET_ERRORS",payload:e.response.data})})}},N=function(){return function(e){e({type:"LOADING_USER"}),u.a.get("/user").then(function(t){e({type:"SET_USER",payload:t.data})}).catch(function(e){console.log("Error setting user."),console.log(e)})}},x=function(e){var t="Bearer ".concat(e);localStorage.setItem("FBIdToken",t),u.a.defaults.headers.common.Authorization=t},I=function(){return function(e){e({type:"LOADING_DOCUMENT"}),u.a.get("/documents").then(function(t){console.log(t.data),e({type:"SET_DOCUMENTS",payload:t.data})}).catch(function(e){console.log("Error retrieving documents."),console.log(e)})}},k=n(149),U=n(151),P=n(150),A=n(157),_=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e))).openDocument=function(e){e.preventDefault(),console.log("Opening document: "+n.props.docID),n.props.getDocument(n.props.docID),setTimeout(function(){n.props.history.push("/editor")},750)},n}return Object(E.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement(o.a.Fragment,null,o.a.createElement(k.a,{className:e.card},o.a.createElement(P.a,null,o.a.createElement(D.a,{className:e.title,color:"textSecondary",gutterBottom:!0},this.props.docID),o.a.createElement(D.a,{variant:"h5",component:"h2"},this.props.title),o.a.createElement(D.a,{className:e.pos,color:"textSecondary"},this.props.users),o.a.createElement(D.a,{variant:"body2",component:"p"},this.props.content)),o.a.createElement(U.a,null,o.a.createElement(A.a,{onClick:this.openDocument},"Open Document"))))}}]),t}(o.a.Component),H={getDocument:function(e){return function(t){t({type:"LOADING_DOCUMENT"}),u.a.get("/document/".concat(e)).then(function(e){t({type:"SET_DOCUMENT",payload:e.data})}).catch(function(e){console.log("Client Error retrieving document."),console.log(e)})}}},R=Object(v.b)(function(e){return{documents:e.documents}},H)(Object(y.a)({card:{minWidth:275,minHeight:275},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12}})(Object(l.f)(_))),M=n(23),L=n(155),W=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e))).handleChange=function(e){n.setState(Object(M.a)({},e.target.name,e.target.value))},n.createNewDocument=function(){console.log(n.props.user.credentials.handle),n.props.createDocument(n.state.title,n.state.content,n.props.user.credentials.handle)},n.state={title:"",content:""},n}return Object(E.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement(k.a,{className:e.card},o.a.createElement(P.a,null,o.a.createElement(D.a,{variant:"h5",component:"h2"},"Create New Document"),o.a.createElement(L.a,{id:"title",name:"title",type:"text",label:"Title",InputProps:{className:e.input},value:this.state.title,onChange:this.handleChange,fullWidth:!0}),o.a.createElement(L.a,{id:"content",name:"content",type:"text",label:"Content",InputProps:{className:e.input},value:this.state.content,onChange:this.handleChange,fullWidth:!0}),o.a.createElement(A.a,{variant:"outlined",className:e.add,onClick:this.createNewDocument},"Submit")))}}]),t}(o.a.Component),B={createDocument:function(e,t,n){return function(a){u.a.post("/document",{title:e,content:t,handle:n}).then(function(e){a({type:"CREATE_DOCUMENT",payload:e.data})}).catch(function(e){console.log("Error creating document."),console.log(e)})}}},F=Object(v.b)(function(e){return{user:e.user}},B)(Object(y.a)({card:{minWidth:275,minHeight:275,position:"relative"},title:{fontSize:14},add:{margin:"20px",right:0,bottom:0,position:"absolute"}})(Object(l.f)(W))),G=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(g.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(o)))).state={documents:null},n}return Object(E.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.props.getDocuments()}},{key:"render",value:function(){var e=this.props.document,t=e.documents,n=e.loading,a=(this.props.classes,n?o.a.createElement("p",null,"Loading..."):t.map(function(e){return o.a.createElement(j.a,{key:e.docID,item:!0,xs:3},o.a.createElement(R,{docID:e.docID,title:e.title,content:e.content}))}));return o.a.createElement(j.a,{container:!0,spacing:10},o.a.createElement(j.a,{item:!0,xs:3},o.a.createElement(F,null)),a)}}]),t}(a.Component),z={loginUser:S,getDocuments:I},J=Object(v.b)(function(e){return{document:e.document,UI:e.UI}},z)(Object(y.a)({})(G)),V=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e))).state={},n}return Object(E.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){var e=this.getTextDocumentRef();setTimeout(function(){},1e4);var t=window.CodeMirror(document.getElementById("firepad-container"),{lineWrapping:!0,lineNumbers:!0});console.log(t);var n=window.Firepad.fromCodeMirror(e,t,{richTextToolbar:!1,richTextShortcuts:!0});console.log(n),n.on("ready",function(){console.log("firepad ready"),n.isHistoryEmpty()&&(console.log("History empty()"),n.setHtml("Collaborative-editing made easy.\n"))})}},{key:"getTextDocumentRef",value:function(){var e=window.firebase.database().ref(),t=this.props.document.activeDocument.docID;return console.log("HASH: "+t),console.log(e),t?e=e.child(t):(e=e.push(),window.location=window.location+"#"+e.key),"undefined"!==typeof console&&console.log("Firebase data: ",e.toString()),e}},{key:"render",value:function(){var e=this.props.classes;return console.log(document.loading),o.a.createElement("div",{className:e.textEditor},o.a.createElement("div",{id:"firepad-container",className:e.firepadContainer}))}}]),t}(a.Component),Y={loginUser:S,getDocuments:I},$=Object(v.b)(function(e){return{document:e.document}},Y)(Object(y.a)(function(e){return{firepadContainer:{backgroundColor:"#282c34",color:"white",height:"1000px",margin:"auto"},textEditor:{}}})(V)),q=Object(T.a)(function(e){return{root:{minHeight:"20vh",backgroundColor:"#282c34",color:"white"}}});function K(){var e=q();return o.a.createElement(w.a,{className:e.root},"This is the Console.")}var Q=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e))).state={},n}return Object(E.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return o.a.createElement(j.a,{container:!0},o.a.createElement(j.a,{item:!0,xs:8,sm:6,md:8},o.a.createElement($,null)),o.a.createElement(j.a,{item:!0,xs:4,sm:6,md:4},o.a.createElement(C,null)),o.a.createElement(j.a,{item:!0,xs:12,sm:12,md:12},o.a.createElement(K,null)))}}]),t}(a.Component),X=Object(v.b)(function(e){return{document:e.document}},{})(Object(y.a)(function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"right",color:e.palette.text.secondary,height:"80vh"}}})(Q)),Z=n(152),ee=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e))).handleChange=function(e){n.setState(Object(M.a)({},e.target.name,e.target.value))},n.handleSubmit=function(e){e.preventDefault();var t={email:n.state.email,password:n.state.password};n.props.loginUser(t,n.props.history)},n.state={email:"",password:"",errors:{}},n}return Object(E.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.classes;return this.state.redirect?o.a.createElement(l.a,{to:"/"+this.state.redirect}):o.a.createElement(j.a,{container:!0,className:e.form},o.a.createElement(j.a,{item:!0,sm:!0}),o.a.createElement(j.a,{item:!0,sm:!0},o.a.createElement(D.a,{variant:"h1",className:e.pageTitle},"Login"),o.a.createElement("form",{noValidate:!0,onSubmit:this.handleSubmit},o.a.createElement(L.a,{id:"email",name:"email",type:"email",label:"Email",InputProps:{className:e.input},value:this.state.email,onChange:this.handleChange,fullWidth:!0}),o.a.createElement(L.a,{id:"password",name:"password",type:"password",label:"Password",InputProps:{className:e.input},value:this.state.password,onChange:this.handleChange,fullWidth:!0}),o.a.createElement(A.a,{type:"submit",variant:"contained",color:"primary",className:e.button},"Login"),o.a.createElement("br",null),o.a.createElement("small",null,"don't have an accound ? sign up ",o.a.createElement(Z.a,{to:"/signup"},"here")))),o.a.createElement(j.a,{item:!0,sm:!0}))}}]),t}(a.Component),te={loginUser:S},ne=Object(v.b)(function(e){return{user:e.user,UI:e.UI}},te)(Object(y.a)({form:{textAlign:"center",paddingTop:"50px"},input:{color:"white"},image:{margin:"20px auto 20px auto",maxWidth:100},pageTitle:{margin:"10px auto 10px auto",fontSize:50},textField:{margin:"10px auto 10px auto",color:"#fff"},button:{marginTop:20,position:"relative"},customError:{color:"red",fontSize:"0.8rem",marginTop:"10px"},progress:{position:"absolute"}})(ee)),ae=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("h1",null,"404: page not found"))}}]),t}(a.Component),oe=n(153),re=n(154),ce=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement(oe.a,{position:"absolute"},o.a.createElement(re.a,{className:e.navContainer},o.a.createElement(A.a,{color:"inherit",component:i.b,to:"/"},"Home"),o.a.createElement(A.a,{color:"inherit",component:i.b,to:"/dashboard"},"Dashboard")))}}]),t}(a.Component),ie=Object(v.b)(function(e){return{}})(Object(y.a)(function(e){return{navContainer:{backgroundColor:"#282c34"}}})(ce)),le=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e))).state={user:null,noUserFound:!1},n}return Object(E.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){this.props.classes;return o.a.createElement("div",null,"Hello from home")}}]),t}(a.Component),se=Object(y.a)({})(le),ue=n(73),me=n(4),pe=function(e){var t=e.component,n=e.authenticated,a=Object(ue.a)(e,["component","authenticated"]);return o.a.createElement(l.b,Object.assign({},a,{render:function(e){return!0===n?o.a.createElement(t,e):o.a.createElement(l.a,{to:"/login"})}}))};pe.prototype={user:n.n(me).a.object};var de=Object(v.b)(function(e){return{authenticated:e.user.authenticated}})(pe),he=n(35),fe=n(71);function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(n,!0).forEach(function(t){Object(M.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Oe={authenticated:!1,loading:!1,credentials:{}};function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(n,!0).forEach(function(t){Object(M.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ye={content:localStorage.getItem("content"),documentHistory:[],currentUsers:[],client:{}};var je=n(72);function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(n,!0).forEach(function(t){Object(M.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var we={activeDocument:null,documents:[],loading:!0},Ce=[fe.a],Se=Object(he.c)({data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CLIENT":return ve({},e,{client:t.payload});case"ON_MESSAGE":return ve({},e,{},t.payload);case"SET_CONTENT":return ve({},e,{content:t.payload});case"SET_HISTORY":return ve({},e,{documentHistory:t.payload});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_AUTHENTICATED":return ge({},e,{authenticated:!0});case"SET_UNAUTHENTICATED":return Oe;case"SET_USER":return ge({loading:!1,authenticated:!0},t.payload);case"LOADING_USER":return ge({},e,{loading:!0});default:return e}},document:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DOCUMENT":return Te({},e,{loading:!0,activeDocument:t.payload});case"SAVE_DOCUMENT":return Te({},e);case"SET_CONTENT":return Te({},e,{activeDocument:Te({},e.activeDocument,{content:t.payload})});case"SET_DOCUMENTS":return Te({},e,{loading:!1,documents:t.payload});case"LOADING_DOCUMENT":return Te({},e,{loading:!0});case"CREATE_DOCUMENT":return Te({},e,{documents:[].concat(Object(je.a)(e.documents),[t.payload])});default:return e}}}),Ne=function(){try{var e=localStorage.getItem("state");if(null===e)return;return JSON.parse(e)}catch(t){console.log("Error loading state.")}}(),xe=Object(he.e)(Se,Ne,Object(he.d)(he.a.apply(void 0,Ce)));xe.subscribe(function(){!function(e){try{var t=JSON.stringify(e);localStorage.setItem("state",t)}catch(n){console.log("Error saving state.")}}(xe.getState())});var Ie=xe;u.a.defaults.baseURL="https://us-central1-novafire-c701c.cloudfunctions.net/api";var ke=localStorage.FBIdToken;if(ke){var Ue=p()(ke);console.log(Ue),1e3*Ue.exp<Date.now()?(Ie.dispatch(function(e){localStorage.removeItem("FBIdToken"),delete u.a.defaults.headers.common.Authorization,e({type:"SET_UNAUTHENTICATED"})}),window.location.href="/login"):(Ie.dispatch({type:"SET_AUTHENTICATED"}),u.a.defaults.headers.common.Authorization=ke,Ie.dispatch(N()))}else console.log("No Token");var Pe=Object(d.a)({productionPrefix:"c"});var Ae=function(){return o.a.createElement(h.b,{generateClassName:Pe},o.a.createElement(v.a,{store:Ie},o.a.createElement(i.a,null,o.a.createElement(ie,null),o.a.createElement("div",{className:"container"},o.a.createElement(l.b,{exact:!0,path:"/",component:se}),o.a.createElement(l.b,{exact:!0,path:"/login",component:ne}),o.a.createElement(de,{exact:!0,path:"/dashboard",component:J}),o.a.createElement(de,{path:"/editor",component:X}),o.a.createElement(l.b,{path:["","/error"],component:ae})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(Ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},83:function(e,t,n){e.exports=n(114)},88:function(e,t,n){},89:function(e,t,n){}},[[83,1,2]]]);
//# sourceMappingURL=main.4be07e51.chunk.js.map